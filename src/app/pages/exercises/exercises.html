<div class="border border-white/10 p-4">
  <div class="flex items-center justify-between mb-4">
    <h2 class="text-xl font-bold">Exercícios</h2>

    <span class="text-sm text-white/60">
      {{ loading() ? 'Carregando…' : (totalRecords() + ' itens') }}
    </span>
  </div>

  <p-table class=""
    [value]="exercises()"
    dataKey="id"
    [lazy]="true"
    (onLazyLoad)="onLazyLoad($event)"
    [totalRecords]="totalRecords()"
    [loading]="loading()"
    [paginator]="true"
    [rows]="8"
    [rowsPerPageOptions]="[8, 16, 32]"
    [scrollable]="true"
    [scrollHeight]="tableHeight"
  >
    <ng-template pTemplate="header">
      <tr>
        <th>Exercício</th>
        <th>Criador</th>
        <th>Dificuldade</th>
        <th>Avaliação</th>
      </tr>
    </ng-template>

    <!-- ✅ Skeleton aparece automaticamente enquanto loading=true -->
    <ng-template pTemplate="loadingbody">
      <tr *ngFor="let _ of skeletonRows">
        <td class="py-3 w-14 h-1"><p-skeleton class="py-3 w-14 h-1"></p-skeleton></td>
        <td class="py-3 w-14 h-1"><p-skeleton class="py-3 w-14 h-1"></p-skeleton></td>
        <td class="py-3 w-14 h-1"><p-skeleton class="py-3 w-14 h-1"></p-skeleton></td>
        <td class="py-3 w-14 h-1"><p-skeleton class="py-3 w-14 h-1"></p-skeleton></td>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-row>
      <tr>
        <td class="font-medium py-3 w-14 h-1" >{{ row.exercise }}</td>
        <td class=" py-3 w-14 h-1" >{{ row.creator }}</td>
        <td class="py-3 w-14 h-1">
          <p-tag
            [value]="row.difficulty"
            [severity]="severityForDifficulty(row.difficulty)"
          ></p-tag>
        </td>
        <td class="py-3 w-14 h-1"> 
          <div class="flex items-center gap-2">
            <p-rating [(ngModel)]="row.rating" [readonly]="true"></p-rating>
            <span class="text-xs text-white/60">{{ row.rating.toFixed(1) }}</span>
          </div>
        </td>
      </tr>
    </ng-template>

    <ng-template pTemplate="emptymessage">
      <tr>
        <td colspan="4" class="py-6 text-center text-white/60">
          Nenhum exercício encontrado.
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
